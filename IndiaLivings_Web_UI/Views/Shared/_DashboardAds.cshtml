@model List<FilteredAd>
@{
    List<int> wishlistIds = ViewBag.WishlistIds ?? new List<int>();
}

@if (!Model.Any())
{
    <p>No ads found</p>
}
else
{
    <div class="tab-pane active" id="ratings">
        <div class="row">
            @foreach (var product in Model)
            {
                <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3">
                    <div class="product-card">
                        <div class="product-media">
                            <div class="product-img">
                                <img src="@Url.Action("GetProductImage", "Dashboard", new { productId = product.ProductId })"
                                     onerror="this.onerror=null;this.src='/images/no-image.png';"
                                     alt="@product.ProductName" width="288" height="205" />
                            </div>
                            <div class="cross-vertical-badge product-badge">
                                <i class="fas fa-clipboard-check"></i>
                                <span>recommend</span>
                            </div>
                            <div class="product-type">
                                <span class="flat-badge @(product.ProductAdCategory.ToLower())">@product.ProductAdCategory</span>
                            </div>
                            <ul class="product-action">
                                <li class="view"><i class="fas fa-eye"></i><span>264</span></li>
                                <li class="click"><i class="fas fa-mouse"></i><span>134</span></li>
                                <li class="rating"><i class="fas fa-star"></i><span>@((product.AverageRating != 0) ? @product.AverageRating + "/5" : "NA")</span></li>
                            </ul>
                        </div>
                        <div class="product-content">
                            <ol class="breadcrumb product-category">
                                <li><i class="fas fa-tags"></i></li>
                                <li class="breadcrumb-item"><a href="#">@product.CategoryName</a></li>
                                <li class="breadcrumb-item active" aria-current="page">@product.SubCategoryName</li>
                            </ol>
                            <h5 class="product-title">
                                <a href="#">@product.ProductName</a>
                            </h5>
                            <div class="product-meta">
                                <span><i class="fas fa-map-marker-alt"></i>@product.UserContactCity</span>
                                <span><i class="fas fa-clock"></i>@product.UpdatedDate.ToString("dd MMM yyyy")</span>
                            </div>
                            <div class="product-info">
                                <h5 class="product-price">₹@Convert.ToInt32(product.ProductPrice)<span>/@product.ProductPriceCondition</span></h5>
                                <div class="product-btn">
                                    <a asp-action="ProductDetails" asp-controller="User" asp-route-username="@product.ProductOwner" asp-route-productId="@product.ProductId" title="Contact Seller" class="fas fa-eye"></a>
                                    @* <a href='#' class='fas fa-compress'
                                       data-toggle='modal' data-target='#productDetailsModal'
                                       onclick='populateModal(@Html.Raw(System.Text.Json.JsonSerializer.Serialize(product)))'>
                                    </a> *@
                                    <button type="button" title="Wishlist" class="@(wishlistIds.Contains(product.ProductId) ? "far fa-heart fas" : "far fa-heart")"
                                            onclick="AddToWishlist(this, '@product.ProductId', '@product.ProductOwner')"></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
}
